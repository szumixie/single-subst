Sub   : Con â†’ Con â†’ Set
p     : Sub (Î“â–¹A) Î“
âŸ¨_âŸ©   : Tm Î“ A â†’ Sub Î“ (Î“â–¹A)
_âº    : Sub Î” Î“ â†’ Sub (Î”â–¹A) (Î“â–¹A)
_[_]  : Tm Î“ A â†’ Sub Î” Î“ â†’ Tm Î” A
q[âº]  : q[Ïƒâº] = q
pâºâŸ¨qâŸ© : t[pâº][âŸ¨qâŸ©] = t

** Define parallel substitutions for the above calculus.

Sub' : Con â†’ Con â†’ Set
Sub' Î” â—‡     := âŠ¤
Sub' Î” (Î“â–¹A) := Sub' Î” Î“ Ã— Tm Î” A

wkfront : (Î”:Con) â†’ Tm Î˜ A â†’ Tm (Î”+Î˜) A
wkfront â—‡     t := t
wkfront (Î”â–¹B) t := wkfront Î” (t[pâº^{Î˜}])
- t : Tm Î˜ A
  pâº^{Î˜} : Sub (â—‡â–¹B+Î˜) (â—‡+Î˜)
  t[pâº^{Î˜}] : Tm (â—‡â–¹B+Î˜)
   
_[_]' : {Î“:Con} â†’ Tm (Î“+Î˜) A â†’ Sub' Î” Î“ â†’ Tm (Î”+Î˜) A
_[_]' {â—‡}   t tt    := wkfront Î” t
_[_]' {Î“â–¹B} t (Ïƒ,u) := (_[_]' {Î“} t Ïƒ)[âŸ¨uâŸ©âº^{Î˜}]
- t : Tm (Î“â–¹B+Î˜) A
  Ïƒ : Sub' Î” Î“
  u : Tm Î” B
  _[_]' {Î“} t Ïƒ : Tm (Î”â–¹B+Î˜) A
  âŸ¨uâŸ© : Sub Î” (Î”â–¹B)
  âŸ¨uâŸ©âº{Î˜} : Sub (Î”+Î˜) (Î”â–¹B+Î˜)

_âˆ˜_ : {Î“:Con} â†’ Sub' Î” Î“ â†’ Sub' Î˜ Î” â†’ Sub' Î˜ Î“
_âˆ˜_ {â—‡}   tt    Ï := tt
_âˆ˜_ {Î“â–¹A} (Ïƒ,t) Ï := (Ïƒâˆ˜Ï,t[Ï]')

wk : {Î“:Con} â†’ Sub' Î” Î“ â†’ Sub' (Î”â–¹B) Î“
wk {â—‡}   tt    := tt
wk {Î“â–¹A} (Ïƒ,t) := wk {Î“} Ïƒ,t[p]

id : {Î“:Con} â†’ Sub' Î“ Î“
id {â—‡}   := tt
id {Î“â–¹A} := (wk (id {Î“}),q)

p' : Sub (Î“â–¹A) Î“
p' := wk id

Now we have to prove the equations.

wkfront[]' : {Î”:Con}{t:Tm Î˜ A}{Ïƒ:Sub' Î Î”} â†’ wkfront Î” t[Ïƒ]' = wkfront Î t
wkfront[]' {â—‡}  {t}{tt}  : wkfront â—‡     t[tt]' = t[tt]' = wkfront Î t
wkfront[]' {Î”â–¹B}{t}{Ïƒ,u} : wkfront (Î”â–¹B) t[Ïƒ,u]' =
                           wkfront Î” (t[pâº^{Î˜}])[Ïƒ,u]' =
                           wkfront Î” (t[pâº^{Î˜}])[Ïƒ]'[âŸ¨uâŸ©âº^{Î˜}] =(wkfront[]' {Î”})
                           wkfront Î (t[pâº^{Î˜}])[âŸ¨uâŸ©âº^{Î˜}] =
                           ? TODO
                           wkfront Î t
  t[pâº^{Î˜}] : Tm (â—‡â–¹B+Î˜) A
  wkfront Î” (t[pâº^{Î˜}]) : Tm (Î”â–¹B+Î˜) A
  wkfront Î” (t[pâº^{Î˜}])[Ïƒ]' : Tm (Îâ–¹B+Î˜) A
  wkfront Î (t[pâº^{Î˜}]) : Tm (Îâ–¹B+Î˜) A
  u : Tm Î B
  âŸ¨uâŸ©âº^{Î˜} : Sub (Î+Î˜) (Îâ–¹B+Î˜)
  

[âˆ˜] : {Î“:Con}{t : Tm (Î“+Î˜) A}{Ïƒ : Sub' Î” Î“}{Ï : Sub' Î Î”} â†’ t[Ïƒâˆ˜Ï]' = t[Ïƒ]'[Ï]'
[âˆ˜] {â—‡} : wkfront Î t = ? wkfront Î” t
- t : Tm Î˜ A
  wkfront Î t : Tm (Î+Î˜) A
  wkfront Î” t : Tm (Î”+Î˜) A
  wkfront Î” t[Ï]' : Tm (Î+Î˜) A

** Maybe it is easier to define the other single substitution calculus

_âº^_ : Sub Î” Î“ â†’ (Î˜:Con) â†’ Sub (Î”+Î˜) (Î“+Î˜)
Ïƒâº^â—‡     := Ïƒ
Ïƒâº^{Î˜â–¹A} := (Ïƒâº^Î˜)âº
   
_âŸ¨Î“,_,Î”âŸ© : Tm (Î“+Î”) A â†’ (B:Ty) â†’ Tm (Î“â–¹B+Î”) A
tâŸ¨Î“,B,Î”âŸ© := t[pâº^Î”]

_âŒˆÎ“,_,Î”âŒ‰ : Tm (Î“â–¹B+Î”) A â†’ (u:Tm Î“ B) â†’ Tm (Î“+Î”) A
tâŒˆÎ“,u,Î”âŒ‰ := t[âŸ¨uâŸ©âº^Î”]

qâŸ¨â–¹âŸ©  : qâŸ¨Î“,A,Î”â–¹BâŸ© = q[pâº^{Î”â–¹B}] = q[(pâº^Î”)âº] =(q[âº]) q
âŸ¨âŸ©âŒˆğ—ŠâŒ‰ : {Î”:Con} â†’ tâŸ¨Î“,A,â—‡â–¹A+Î”âŸ©âŒˆÎ“â–¹A,q,Î”âŒ‰ = t[pâº^{â—‡â–¹A+Î”}][âŸ¨qâŸ©âº^{Î”}] = t
âŸ¨âŸ©âŒˆğ—ŠâŒ‰ {â—‡}   : t[pâº^{â—‡â–¹A+â—‡}][âŸ¨qâŸ©âº^{â—‡}] = t[pâº][âŸ¨qâŸ©] =(pâºâŸ¨qâŸ©) t
âŸ¨âŸ©âŒˆqâŒ‰ {â—‡â–¹B} : t[pâº^{â—‡â–¹Aâ–¹B}][âŸ¨qâŸ©âº^{â—‡â–¹B}] = t[pâºâº][âŸ¨qâŸ©âº] = ? t
âŸ¨âŸ©âŒˆğ—ŠâŒ‰ {Î”â–¹B} : t[pâº^{â—‡â–¹A+Î”â–¹B}][âŸ¨qâŸ©âº^{Î”â–¹B}] = t[(pâº^{â—‡â–¹A+Î”})âº][(âŸ¨qâŸ©âº^{Î”})âº] =   ? = t
  âŸ¨âŸ©âŒˆqâŒ‰ {Î”} : ?[pâº^{â—‡â–¹A+Î”}][âŸ¨qâŸ©âº^{Î”}] = ?

** THIS PROJECT FAILED
It seems that we don't have a simpler definition for the single
substitution calculus than what we did with Luksa Norbert. I don't see
how to encode all the equations
t[pâº][âŸ¨qâŸ©] = t
t[pâºâº][âŸ¨qâŸ©âº] = t
t[pâºâºâº][âŸ¨qâŸ©âºâº] = t
t[pâºâºâºâº][âŸ¨qâŸ©âºâºâº] = t
...
in one go. The quasi-equation solutions are not strictly positive.

We don't need these equations.

If you define true : Tm â—‡ Bool, you can weaken it to any finite context true [ p ] [ p ] [ p ] [ p ] : Tm (â—‡ â–¹ A â–¹ B â–¹ C â–¹ D) Bool, etc.
